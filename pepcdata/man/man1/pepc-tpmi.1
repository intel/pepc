.\" Automatically generated by Pandoc 3.6.4
.\"
.TH "TPMI" "" "" ""
.SH Command \f[I]\[aq]tpmi\[aq]\f[R]
.SS Background
TPMI, or Topology Aware Register and PM Capsule Interface, is a
memory\-mapped interface for accessing processor registers related to
power management on Intel CPUs.
.PP
These registers are exposed via PCIe VSEC (Vendor\-Specific Extended
Capabilities) and grouped into TPMI features.
For instance, the \[dq]ufs\[dq] feature includes registers for uncore
frequency scaling, the \[dq]rapl\[dq] feature covers Running Average
Power Limit (RAPL) registers, and the \[dq]sst\[dq] feature includes
registers for Intel Speed Select Technology (SST).
.PP
To decode TPMI features, the \[aq]pepc\[aq] tool requires a spec file
describing register names, bits, and offsets in the PCIe memory\-mapped
address space.
Features without a spec file cannot be decoded.
.PP
The \[aq]pepc\[aq] project includes spec files for some, but not all
TPMI features.
Spec files for other features can be requested from Intel Corporation
via customer support channels.
.PP
The spec files are searched in the following locations and order:
.RS
.IP "1." 3
\[aq]./tpmi\[aq], in the directory of the running program
.IP "2." 3
\[aq]$PEPC_TPMI_DATA_PATH/tpmi\[aq]
.IP "3." 3
\[aq]$HOME/.local/share/pepc/tpmi\[aq]
.IP "4." 3
\[aq]$VIRTUAL_ENV/share/pepc/tpmi\[aq]
.IP "5." 3
\[aq]/usr/local/share/pepc/tpmi\[aq]
.IP "6." 3
\[aq]/usr/share/pepc/tpmi\[aq]
.RE
.PP
The \[aq]PEPC_TPMI_DATA_PATH\[aq] provides a mechanism for replacing or
extending the standard spec files.
Just set it to a directory with spec files to have \[aq]pepc\[aq] use
them.
.PP
Spec files are YAML files, but they are generated from Intel proprietary
XML files using the \[aq]tpmi\-spec\-files\-generator\[aq] tool
available in the \[aq]pepc\[aq] source code repository.
.SS General options
.TP
\f[B]\-h\f[R]
Show a short help message and exit.
.TP
\f[B]\-q\f[R]
Be quiet (print only improtant messages like warnings).
.TP
\f[B]\-d\f[R]
Print debugging information.
.TP
\f[B]\-\-debug\-modules\f[R] \f[I]MODNAME[,MODNAME1,...]\f[R]
While the \[aq]\-d\[aq] option enables all debug messages, this option
limits them to the specified modules.
For example, \[aq]\-d \-\-debug\-modules MSR\[aq] will only show debug
messages from the \[aq]MSR\[aq] module.
.TP
\f[B]\-\-version\f[R]
Print the version number and exit.
.TP
\f[B]\-H\f[R] \f[I]HOSTNAME\f[R], \f[B]\-\-host\f[R] \f[I]HOSTNAME\f[R]
User name for SSH login to the remote host.
Defaults to \[aq]root.
.TP
\f[B]\-U\f[R] \f[I]USERNAME\f[R], \f[B]\-\-username\f[R] \f[I]USERNAME\f[R]
Name of the user to use for logging into the remote host over SSH.
The default user name is \[aq]root\[aq].
.TP
\f[B]\-K\f[R] \f[I]PRIVKEY\f[R], \f[B]\-\-priv\-key\f[R] \f[I]PRIVKEY\f[R]
Path to the private SSH key for logging into the remote host.
Defaults to keys in standard paths like \[aq]$HOME/.ssh\[aq].
.TP
\f[B]\-T\f[R] \f[I]TIMEOUT\f[R], \f[B]\-\-timeout\f[R] \f[I]TIMEOUT\f[R]
Timeout for establishing an SSH connection in seconds.
Defaults to 8.
.TP
\f[B]\-D\f[R] \f[I]DATASET\f[R], \f[B]\-\-dataset\f[R] \f[I]DATASET\f[R]
This option is for debugging and testing.
It specifies the dataset to use for emulating the host for running the
command on.
The datasets are available in \[aq]pepc\[aq] source code repository.
.RS
.PP
The argument can be a dataset path or name.
If specified by name, the following locations are searched for the
dataset.
.IP "1." 3
\[aq]./tests/emul\-data\[aq] in the program\[aq]s directory
.IP "2." 3
\[aq]$PEPC_DATA_PATH/tests/emul\-data\[aq]
.IP "3." 3
\[aq]$HOME/.local/share/pepc/tests/emul\-data\[aq]
.IP "4." 3
\[aq]$VIRTUAL_ENV/share/tests/emul\-data\[aq]
.IP "5." 3
\[aq]/usr/local/share/pepc/tests/emul\-data\[aq]
.IP "6." 3
\[aq]/usr/share/pepc/tests/emul\-data\[aq]
.RE
.TP
\f[B]\-\-force\-color\f[R]
Force colorized output even if the output stream is not a terminal (adds
ANSI escape codes).
.TP
\f[B]\-\-print\-man\-path\f[R]
Print path to pepc manual pages directory and exit.
This path can be added to the \[aq]MANPATH\[aq] environment variable to
make the manual pages available to the \[aq]man\[aq] tool.
.SS Subcommand \f[I]\[aq]ls\[aq]\f[R]
Display supported TPMI features.
.TP
\f[B]\-l\f[R], \f[B]\-\-long\f[R]
Include details like TPMI device PCI addresses and instance numbers for
more specific output.
.TP
\f[B]\-\-all\f[R]
Include IDs of TPMI features supported by the processor but lacking spec
files for decoding.
.SS Subcommand \f[I]\[aq]read\[aq]\f[R]
Read one or more TPMI registers.
.TP
\f[B]\-F\f[R] FEATURES, \f[B]\-\-features\f[R] FEATURES
Comma\-separated list of TPMI feature names to read the registers for.
Defaults to all supported features.
.TP
\f[B]\-a\f[R] ADDRS, \f[B]\-\-addresses\f[R] ADDRS
Comma\-separated list of TPMI device PCI addresses to read the registers
from.
Defaults to all devices.
.TP
\f[B]\-\-packages\f[R] PACKAGES
Comma\-separated list of package numbers to read TPMI registers for
(defaults to all packages).
.TP
\f[B]\-i\f[R] INSTANCES, \f[B]\-\-instances\f[R] INSTANCES
Comma\-separated list of TPMI instance numbers to read registers from
(defaults to all instances).
.TP
\f[B]\-R\f[R] REGISTERS, \f[B]\-\-registers\f[R] REGISTERS
Comma\-separated list of TPMI register names to read.
Defaults to all registers.
.TP
\f[B]\-b\f[R] BFNAMES, \f[B]\-\-bitfields\f[R] BFNAMES
Comma\-separated list of TPMI register bit field names to read.
Defaults to all bit fields.
.TP
\f[B]\-\-yaml\f[R]
Output information in YAML format.
.SS Subcommand \f[I]\[aq]write\[aq]\f[R]
Write a value to a TPMI register or its bit field.
.TP
\f[B]\-F\f[R] FEATURE, \f[B]\-\-feature\f[R] FEATURE
Name of the TPMI feature the register belongs to.
.TP
\f[B]\-a\f[R] ADDRS, \f[B]\-\-addresses\f[R] ADDRS
Comma\-separated list of PCI addresses of TPMI devices to write to.
.TP
\f[B]\-\-packages\f[R] PACKAGES
Comma\-separated list of package numbers to write to (defaults to all
packages).
.TP
\f[B]\-i\f[R] INSTANCES, \f[B]\-\-instances\f[R] INSTANCES
Comma\-separated list of TPMI instance numbers to write to.
Defaults to all instances.
.TP
\f[B]\-R\f[R] REGNAME, \f[B]\-\-register\f[R] REGNAME
Name of the TPMI register to write.
.TP
\f[B]\-b\f[R] BITFIELD, \f[B]\-\-bitfield\f[R] BITFIELD
Name of the TPMI register bitfield to write.
Defaults to writing to the entire register if not specified.
.TP
\f[B]\-V\f[R] VALUE, \f[B]\-\-value\f[R] VALUE
Value to write to the TPMI register or bit field.
