.\" Automatically generated by Pandoc 3.6.4
.\"
.TH "TPMI" "" "" ""
.SH Command \f[I]\[aq]tpmi\[aq]\f[R]
.SS Background
TPMI, or Topology Aware Register and PM Capsule Interface, is a
memory\-mapped interface for accessing processor registers related to
power management on Intel CPUs.
.PP
These registers are exposed via PCIe VSEC (Vendor\-Specific Extended
Capabilities) and grouped into TPMI features.
For instance, the \[dq]ufs\[dq] feature includes registers for uncore
frequency scaling, the \[dq]rapl\[dq] feature covers Running Average
Power Limit (RAPL) registers, and the \[dq]sst\[dq] feature includes
registers for Intel Speed Select Technology (SST).
.PP
To decode TPMI features, the \[aq]pepc\[aq] tool requires a spec file
describing register names, bits, and offsets in the PCIe memory\-mapped
address space.
Features without a spec file cannot be decoded.
.PP
The \[aq]pepc\[aq] project includes spec files for some, but not all
TPMI features.
Spec files for other features can be requested from Intel Corporation
via customer support channels.
.PP
The spec files are searched in the following locations and order:
.RS
.IP "1." 3
\[aq]./tpmi\[aq], in the directory of the running program
.IP "2." 3
\[aq]$PEPC_TPMI_DATA_PATH/tpmi\[aq]
.IP "3." 3
\[aq]$HOME/.local/share/pepc/tpmi\[aq]
.IP "4." 3
\[aq]$VIRTUAL_ENV/share/pepc/tpmi\[aq]
.IP "5." 3
\[aq]/usr/local/share/pepc/tpmi\[aq]
.IP "6." 3
\[aq]/usr/share/pepc/tpmi\[aq]
.RE
.PP
The \[aq]PEPC_TPMI_DATA_PATH\[aq] provides a mechanism for replacing or
extending the standard spec files.
Just set it to a directory with spec files to have \[aq]pepc\[aq] use
them.
.PP
Spec files are YAML files, but they are generated from Intel proprietary
XML files using the \[aq]tpmi\-spec\-files\-generator\[aq] tool
available in the \[aq]pepc\[aq] source code repository.
.SS General options
.TP
\f[B]\-h\f[R]
Show a short help message and exit.
.TP
\f[B]\-q\f[R]
Be quiet (print only important messages like warnings).
.TP
\f[B]\-d\f[R]
Print debugging information.
.TP
\f[B]\-\-debug\-modules\f[R] \f[I]MODNAME[,MODNAME1,...]\f[R]
While the \[aq]\-d\[aq] option enables all debug messages, this option
limits them to the specified modules.
For example, \[aq]\-d \-\-debug\-modules MSR\[aq] will only show debug
messages from the \[aq]MSR\[aq] module.
.TP
\f[B]\-\-version\f[R]
Print the version number and exit.
.TP
\f[B]\-H\f[R] \f[I]HOSTNAME\f[R], \f[B]\-\-host\f[R] \f[I]HOSTNAME\f[R]
Host name or IP address of the target system.
The pepc command will be executed on this system using SSH, instead of
running it locally.
If not specified, the command will be run locally.
.TP
\f[B]\-U\f[R] \f[I]USERNAME\f[R], \f[B]\-\-username\f[R] \f[I]USERNAME\f[R]
Name of the user to use for logging into the remote host over SSH.
The default user name is \[aq]root\[aq].
.TP
\f[B]\-K\f[R] \f[I]PRIVKEY\f[R], \f[B]\-\-priv\-key\f[R] \f[I]PRIVKEY\f[R]
Path to the private SSH key for logging into the remote host.
Defaults to keys in standard paths like \[aq]$HOME/.ssh\[aq].
.TP
\f[B]\-T\f[R] \f[I]TIMEOUT\f[R], \f[B]\-\-timeout\f[R] \f[I]TIMEOUT\f[R]
Timeout for establishing an SSH connection in seconds.
Defaults to 8.
.TP
\f[B]\-D\f[R] \f[I]DATASET\f[R], \f[B]\-\-dataset\f[R] \f[I]DATASET\f[R]
This option is for debugging and testing.
It specifies the dataset to use for emulating the host for running the
command on.
The datasets are available in \[aq]pepc\[aq] source code repository.
.RS
.PP
The argument can be a dataset path or name.
If specified by name, the following locations are searched for the
dataset.
.IP "1." 3
\[aq]./tests/emul\-data\[aq] in the program\[aq]s directory
.IP "2." 3
\[aq]$PEPC_DATA_PATH/tests/emul\-data\[aq]
.IP "3." 3
\[aq]$HOME/.local/share/pepc/tests/emul\-data\[aq]
.IP "4." 3
\[aq]$VIRTUAL_ENV/share/tests/emul\-data\[aq]
.IP "5." 3
\[aq]/usr/local/share/pepc/tests/emul\-data\[aq]
.IP "6." 3
\[aq]/usr/share/pepc/tests/emul\-data\[aq]
.RE
.TP
\f[B]\-\-force\-color\f[R]
Force colorized output even if the output stream is not a terminal (adds
ANSI escape codes).
.TP
\f[B]\-\-print\-man\-path\f[R]
Print path to pepc manual pages directory and exit.
This path can be added to the \[aq]MANPATH\[aq] environment variable to
make the manual pages available to the \[aq]man\[aq] tool.
.SS Subcommand \f[I]\[aq]ls\[aq]\f[R]
Display supported TPMI features.
.TP
\f[B]\-\-list\-specs\f[R]
Display information about TPMI spec files for the target system and
exit.
Show the detected CPU model and available spec files for that model.
Spec directories may contain files for different CPU models.
Select files matching the target system.
Note that the target system may not support all TPMI features described
in the spec files.
.TP
\f[B]\-t\f[R], \f[B]\-\-topology\f[R]
Display TPMI topology (PCI addresses, instance numbers, etc.).
.TP
\f[B]\-\-unimplemented\f[R]
Include unimplemented TPMI instances.
Unimplemented instances have version number 0xFF and represent
\[dq]empty slots\[dq] in the instances table of a TPMI feature.
For example, there instance 0 may be implemented, instance 1 may be
unimplemented (version 0xFF), and instance 2 may be implemented.
By default, unimplemented instances are not shown in the output.
.TP
\f[B]\-F\f[R] \f[I][FEATURES]\f[R], \f[B]\-\-features\f[R] \f[I][FEATURES]\f[R]
Comma\-separated list of TPMI feature names to include in the output.
Defaults to all supported features.
.TP
\f[B]\-\-unknown\f[R]
Include TPMI features without spec files (unknown features).
.TP
\f[B]\-\-yaml\f[R]
Display information in YAML format.
.SS Subcommand \f[I]\[aq]read\[aq]\f[R]
Read one or more TPMI registers.
.TP
\f[B]\-F\f[R] \f[I][FEATURES]\f[R], \f[B]\-\-features\f[R] \f[I][FEATURES]\f[R]
Comma\-separated list of TPMI feature names to read the registers for.
Defaults to all supported features.
.TP
\f[B]\-a\f[R] \f[I][ADDRS]\f[R], \f[B]\-\-addresses\f[R] \f[I][ADDRS]\f[R]
Comma\-separated list of TPMI device PCI addresses to read the registers
from.
Defaults to all devices.
.TP
\f[B]\-\-packages\f[R] \f[I][PACKAGES]\f[R]
Comma\-separated list of package numbers to read TPMI registers for
(defaults to all packages).
.TP
\f[B]\-i\f[R] \f[I][INSTANCES]\f[R], \f[B]\-\-instances\f[R] \f[I][INSTANCES]\f[R]
Comma\-separated list of TPMI instance numbers to read registers from
(defaults to all instances).
.TP
\f[B]\-c\f[R] \f[I][CLUSTERS]\f[R], \f[B]\-\-clusters\f[R] \f[I][CLUSTERS]\f[R]
Comma\-separated list of cluster numbers to read registers from
(defaults to all clusters).
This option is only relevant for the \[aq]ufs\[aq] TPMI feature, because
there may be multiple copies of UFS control registers within a TPMI
instance, and the copies are referred to as clusters.
All other TPMI features have only one cluster \- cluster 0.
.TP
\f[B]\-R\f[R] \f[I][REGISTERS]\f[R], \f[B]\-\-registers\f[R] \f[I][REGISTERS]\f[R]
Comma\-separated list of TPMI register names to read.
Defaults to all registers.
.TP
\f[B]\-b\f[R] \f[I][BFNAMES]\f[R], \f[B]\-\-bitfields\f[R] \f[I][BFNAMES]\f[R]
Comma\-separated list of TPMI register bit field names to decode.
Defaults to decoding all bit fields.
.TP
\f[B]\-n\f[R], \f[B]\-\-no\-bitfields\f[R]
Do not decode and display TPMI register bit field values.
When this option is specified, only register values will be displayed
without decoding the individual bit fields within them.
.TP
\f[B]\-\-yaml\f[R]
Display information in YAML format.
.SS Subcommand \f[I]\[aq]write\[aq]\f[R]
Write a value to a TPMI register or its bit field.
.TP
\f[B]\-F\f[R] \f[I]FEATURE\f[R], \f[B]\-\-feature\f[R] \f[I]FEATURE\f[R]
Name of the TPMI feature the register belongs to.
.TP
\f[B]\-a\f[R] \f[I]ADDRS\f[R], \f[B]\-\-addresses\f[R] \f[I]ADDRS\f[R]
Comma\-separated list of PCI addresses of TPMI devices to write to.
.TP
\f[B]\-\-packages\f[R] \f[I]PACKAGES\f[R]
Comma\-separated list of package numbers to write to (defaults to all
packages).
.TP
\f[B]\-i\f[R] \f[I]INSTANCES\f[R], \f[B]\-\-instances\f[R] \f[I]INSTANCES\f[R]
Comma\-separated list of TPMI instance numbers to write to.
Defaults to all instances.
.TP
\f[B]\-c\f[R] \f[I][CLUSTERS]\f[R], \f[B]\-\-clusters\f[R] \f[I][CLUSTERS]\f[R]
Comma\-separated list of cluster numbers to write to (defaults to all
clusters).
This option is only relevant for the \[aq]ufs\[aq] TPMI feature, because
there may be multiple copies of UFS control registers within a TPMI
instance, and the copies are referred to as clusters.
All other TPMI features have only one cluster \- cluster 0.
.TP
\f[B]\-R\f[R] \f[I]REGNAME\f[R], \f[B]\-\-register\f[R] \f[I]REGNAME\f[R]
Name of the TPMI register to write.
.TP
\f[B]\-b\f[R] \f[I]BITFIELD\f[R], \f[B]\-\-bitfield\f[R] \f[I]BITFIELD\f[R]
Name of the TPMI register bit field to write to.
If this option is not specified, the value will be written to the entire
register.
When specified, only the specified bit field within the register will be
modified.
.TP
\f[B]\-V\f[R] \f[I]VALUE\f[R], \f[B]\-\-value\f[R] \f[I]VALUE\f[R]
Value to write to the TPMI register or bit field.
