.\" Automatically generated by Pandoc 3.1.3
.\"
.\" Define V font for inline verbatim, using C font in formats
.\" that render this, and otherwise B font.
.ie "\f[CB]x\f[]"x" \{\
. ftr V B
. ftr VI BI
. ftr VB B
. ftr VBI BI
.\}
.el \{\
. ftr V CR
. ftr VI CI
. ftr VB CB
. ftr VBI CBI
.\}
.TH "ASPM" "" "09-02-2024" "" ""
.hy
.SH Command \f[I]\[aq]tpmi\[aq]\f[R]
.SS Background
.PP
TPMI stands for Topology Aware Register and PM Capsule Interface and it
is a memory-mapped interface for reading and writing processor\[aq]s
registers related to power management features on Intel CPUs.
.PP
TPMI registers are exposed by the processor via PCIe VSEC
(Vendor-Specific Extended Capabilities), and the registers are grouped
into TPMI features.
For example, the \[dq]uncore\[dq] TPMI feature includes processor
registers related to uncore frequency scaling.
The \[dq]rapl\[dq] TPMI feature includes processor registers related to
processor\[aq]s Running Average Power Limit (RAPL).
The \[dq]sst\[dq] feature includes processor registers related to Intel
Speed Select Technology (SST).
.PP
In order for the \[aq]pepc\[aq] tool to decode TPMI features, the spec
file is required.
The spec file describes the register names, bits, and offsets in the
memory-mapped PCIe address space.
If there is no spec file for a feature, it cannot be decoded.
.PP
The \[aq]pepc\[aq] project comes with some standard pepc files, which
will be searched for in the following locations and in the following
order.
.RS
.IP "1." 3
\[aq]./tpmi\[aq], in the directory of the running program
.IP "2." 3
\[aq]$PEPC_DATA_PATH/tpmi\[aq]
.IP "3." 3
\[aq]$HOME/.local/share/pepc/tpmi\[aq]
.IP "4." 3
\[aq]/usr/local/share/pepc/tpmi\[aq]
.IP "5." 3
\[aq]/usr/share/pepc/tpmi\[aq]
.RE
.PP
In addition to this, users can provide custom/private spec files by
placing them to a directory and specifying the directory path via the
\[aq]PEPC_TPMI_DATA_PATH\[aq] environment variable.
.SS General options
.TP
\f[B]-h\f[R]
Show a short help message and exit.
.TP
\f[B]-q\f[R]
Be quiet.
.TP
\f[B]-d\f[R]
Print debugging information.
.TP
\f[B]--version\f[R]
Print version and exit.
.TP
\f[B]-H\f[R] \f[I]HOSTNAME\f[R], \f[B]--host\f[R] \f[I]HOSTNAME\f[R]
Name of the host to run the command on.
.TP
\f[B]-U\f[R] \f[I]USERNAME\f[R], \f[B]--username\f[R] \f[I]USERNAME\f[R]
Name of the user to use for logging into the remote host over SSH.
The default user name is \[aq]root\[aq].
.TP
\f[B]-K\f[R] \f[I]PRIVKEY\f[R], \f[B]--priv-key\f[R] \f[I]PRIVKEY\f[R]
Path to the private SSH key that should be used for logging into the
remote host.
By default the key is automatically found from standard paths like
\[aq]$HOME/.ssh\[aq].
.TP
\f[B]-T\f[R] \f[I]TIMEOUT\f[R], \f[B]--timeout\f[R] \f[I]TIMEOUT\f[R]
SSH connection timeout in seconds, default is 8.
.TP
\f[B]-D\f[R] \f[I]DATASET\f[R], \f[B]--dataset\f[R] \f[I]DATASET\f[R]
This option is for debugging and testing purposes only, it defines the
dataset that will be used to emulate a host for running the command on.
This option is typically used when running \[aq]pepc\[aq] from the
source code directory, which includes datasets for many different
systems.
.RS
.PP
The argument can be the dataset path, \[aq]all\[aq] to specify all
available dataset or name in which case the following locations will be
searched for.
.IP "1." 3
\[aq]./tests/data\[aq], in the directory of the running program
.IP "2." 3
\[aq]$PEPC_DATA_PATH/tests/data\[aq]
.IP "3." 3
\[aq]$HOME/.local/share/pepc/tests/data\[aq]
.IP "4." 3
\[aq]/usr/local/share/pepc/tests/data\[aq]
.IP "5." 3
\[aq]/usr/share/pepc/tests/data\[aq]
.RE
.TP
\f[B]--force-color\f[R]
Force coloring of the text output.
.SS Subcommand \f[I]\[aq]ls\[aq]\f[R]
.PP
List supported TPMI features.
.TP
\f[B]-l\f[R], \f[B]--long\f[R]
Provide additional information, such as TPMI device PCI addresses and
TPMI instance numbers.
.TP
\f[B]--all\f[R]
Also print IDs of TPMI features supported by the processor, but for
which there are no spec files, so they cannot be decoded.
.SS Subcommand \f[I]\[aq]read\[aq]\f[R]
.PP
Read one or multiple TPMI registers.
.TP
\f[B]-F\f[R] FEATURES, \f[B]--features\f[R] FEATURES
Comma-separated list of TPMI feature names to read the register(s) for.
Read for all supported features by default.
.TP
\f[B]-a\f[R] ADDRS, \f[B]--addresses\f[R] ADDRS
Comma-separated list of TPMI device PCI addresses to read the registers
from.
Read from all devices by default.
.TP
\f[B]--packages\f[R] PACKAGES
Comma-separated list of integer package numbers to read TPMI registers
for (all packages by default).
.TP
\f[B]-i\f[R] INSTANCES, \f[B]--instances\f[R] INSTANCES
Comma-separated list of integer TPMI instance numbers to read the
registers from (all instances by default).
.TP
\f[B]-R\f[R] REGISTERS, \f[B]--registers\f[R] REGISTERS
Comma-separated list of TPMI registers names to read (all registers by
default).
.TP
\f[B]-b\f[R] BFNAMES, \f[B]--bitfields\f[R] BFNAMES
Comma-separated list of TPMI register bit field names to read (all bit
fields by default).
.TP
\f[B]--yaml\f[R]
Print information in YAML format.
.SS Subcommand \f[I]\[aq]write\[aq]\f[R]
.PP
Write to a TPMI register.
.TP
\f[B]-F\f[R] FEATURE, \f[B]--feature\f[R] FEATURE
Name of the TPMI feature the register belongs to.
.TP
\f[B]-a\f[R] ADDRS, \f[B]--addresses\f[R] ADDRS
Comma-separated list of TPMI device PCI addresses to write to.
.TP
\f[B]--packages\f[R] PACKAGES
Comma-separated list of package numbers to write the TPMI register for
(all packages by default).
.TP
\f[B]-i\f[R] INSTANCES, \f[B]--instances\f[R] INSTANCES
Comma-separated list of integer TPMI instance numbers to write to (all
instances by default).
.TP
\f[B]-R\f[R] REGNAME, \f[B]--register\f[R] REGNAME
Name of the TPMI register to write to.
.TP
\f[B]-b\f[R] BITFIELD, \f[B]--bitfield\f[R] BITFIELD
Name of the TPMI register bitfield to write to.
If not specified, write to the register, not a bit field of the
register.
.TP
\f[B]-V\f[R] VALUE, \f[B]--value\f[R] VALUE
The value to write to the TPMI register or its bit field.
